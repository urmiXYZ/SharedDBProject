@model MDUA.Entities.ProductResult

<div class="edit-product-container p-0">
    <form method="post" asp-controller="Product" asp-action="EditProduct" id="editProductForm">
        @Html.AntiForgeryToken()

        <input type="hidden" asp-for="Product.Id" />
        <input type="hidden" asp-for="Product.CreatedBy" />
        <input type="hidden" asp-for="Product.CreatedAt" />
        <input type="hidden" asp-for="Product.CompanyId" />
        <input type="hidden" asp-for="Product.IsActive" />
        <input type="hidden" asp-for="Product.UpdatedAt" />

        <div class="row g-0">
            <div class="col-lg-8 p-4">
                <div class="mb-3">
                    <label asp-for="Product.ProductName" class="form-label fw-bold text-muted small text-uppercase">Product Name</label>
                    <input asp-for="Product.ProductName" class="form-control fw-bold" placeholder="e.g. Premium T-Shirt" required />
                    <span asp-validation-for="Product.ProductName" class="text-danger small"></span>
                </div>

                <div class="mb-0">
                    <label asp-for="Product.Description" class="form-label fw-bold text-muted small text-uppercase">Description</label>
                    <textarea asp-for="Product.Description" id="summernote-edit" class="form-control"></textarea>
                    <span asp-validation-for="Product.Description" class="text-danger small"></span>
                </div>
            </div>

            <div class="col-lg-4 bg-light bg-opacity-50 border-start p-4">
                <h6 class="text-uppercase text-muted small fw-bold mb-3 border-bottom pb-2">Configuration</h6>

                <div class="mb-3">
                    <label asp-for="Product.CategoryId" class="form-label fw-bold small text-dark">Category</label>
                    <select asp-for="Product.CategoryId"
                            asp-items="@(new SelectList(Model.Categories, "Id", "Name", Model.Product.CategoryId))"
                            class="form-select form-select-sm bg-white" required>
                        <option value="">-- Select --</option>
                    </select>
                    <span asp-validation-for="Product.CategoryId" class="text-danger small"></span>
                </div>

                <div class="mb-3">
                    <label asp-for="Product.BasePrice" class="form-label fw-bold small text-dark">Base Price</label>
                    <div class="input-group input-group-sm">
                        <span class="input-group-text bg-white text-success fw-bold">Tk.</span>
                        <input asp-for="Product.BasePrice" class="form-control" type="number" step="0.01" required />
                    </div>
                    <span asp-validation-for="Product.BasePrice" class="text-danger small"></span>
                </div>

                <div class="mb-3">
                    <label asp-for="Product.ReorderLevel" class="form-label fw-bold small text-dark">Reorder Level</label>
                    <input asp-for="Product.ReorderLevel" class="form-control form-control-sm" type="number" required />
                </div>

                <div class="mb-2">
                    <label class="form-label fw-bold small text-muted">Slug <span title="Locked">🔒</span></label>
                    <input asp-for="Product.Slug" class="form-control form-control-sm bg-secondary bg-opacity-10 text-muted" readonly />
                </div>
            </div>
        </div>

        <div class="modal-footer border-top px-4 py-2 bg-white">
            <button type="button" class="btn btn-light border btn-sm" data-bs-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-primary btn-sm px-4 fw-bold shadow-sm">
                Save Changes
            </button>
        </div>
    </form>
</div>

<script>
    $(document).ready(function() {
        // Destroy existing instance to prevent duplicates/errors
        if ($('#summernote-edit').next('.note-editor').length > 0) {
            $('#summernote-edit').summernote('destroy');
        }

        $('#summernote-edit').summernote({
            placeholder: 'Edit product details...',
            tabsize: 2,
            height: 220, // Slightly taller for the layout

            // ✅ Essential for Modals
            dialogsInBody: true,

            toolbar: [
                ['style', ['style']],
                ['font', ['bold', 'underline', 'clear']],
                ['color', ['color']],
                ['para', ['ul', 'ol', 'paragraph']],
                ['insert', ['link', 'picture', 'video']], // Video button is here
                ['view', ['fullscreen', 'codeview', 'help']]
            ],
            callbacks: {
                onPaste: function (e) {
                    var bufferText = ((e.originalEvent || e).clipboardData || window.clipboardData).getData('Text');
                    e.preventDefault();
                    document.execCommand('insertText', false, bufferText);
                }
            }
        });
    });
</script>